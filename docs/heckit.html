
<!DOCTYPE HTML>
<html lang="ja" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Heckit · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="site.html" />
    
    
    <link rel="prev" href="regression.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="検索すると入力" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Top
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="regression.html">
            
                <a href="regression.html">
            
                    
                    線形回帰
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="heckit.html">
            
                <a href="heckit.html">
            
                    
                    Heckit
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="site.html">
            
                <a href="site.html">
            
                    
                    本サイト
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            GitBookで公開 
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Heckit</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="heckit">Heckit</h1>
<p>&#x300C;<script type="math/tex; "> f(x) = \int dx </script>&#x300D; &#x2190; &#x3053;&#x3053;&#x306B;&#x6570;&#x5F0F;&#x306E;&#x3088;&#x3046;&#x306A;&#x3082;&#x306E;&#x304C;&#x8868;&#x793A;&#x3055;&#x308C;&#x3066;&#x3044;&#x306A;&#x3044;&#x5834;&#x5408;&#x306F;&#x3001;&#x304A;&#x624B;&#x6570;&#x3067;&#x3059;&#x304C;&#x3053;&#x306E;&#x30DA;&#x30FC;&#x30B8;&#x3092;&#x518D;&#x8AAD;&#x307F;&#x8FBC;&#x307F;&#xFF08;F5&#xFF09;&#x3057;&#x3066;&#x304F;&#x3060;&#x3055;&#x3044;&#x3002;&#x6570;&#x5F0F;&#x306E;&#x8868;&#x793A;&#x30A8;&#x30E9;&#x30FC;&#x304C;&#x751F;&#x3058;&#x3066;&#x3044;&#x307E;&#x3059;&#xFF08;&#x56F0;&#xFF09;&#x3002;</p>
<p>James J. Heckman, the Nobel laureate &#x306B;&#x3088;&#x308B;2&#x6BB5;&#x968E;&#x63A8;&#x5B9A;&#x3002;&#x901A;&#x79F0;Heckit&#xFF08;&#x30D8;&#x30AD;&#x30C3;&#x30C8;&#xFF09;&#x3002;</p>
<!--
__目次__

- [参考文献](#参考文献)
- [前提知識](#前提知識)
    - [切断正規分布](#切断正規分布)
    - [サンプルセレクションモデルの概要](#サンプルセレクションモデルの概要)
    - [Tobitモデル [CT05, § 16.3]](#tobitモデル-ct05-§-163)
- [ようやく本題](#ようやく本題)
- [統計ソフトウェア](#統計ソフトウェア)
    - [R](#r)
    - [Stata](#stata)
-->
<!-- TOC -->
<h2 id="&#x53C2;&#x8003;&#x6587;&#x732E;">&#x53C2;&#x8003;&#x6587;&#x732E;</h2>
<ul>
<li>&#x5C71;&#x672C;&#x52F2;&#x300E;<a href="https://www.biz-book.jp/isbn/978-4-502-16811-6" target="_blank">&#x5B9F;&#x8A3C;&#x5206;&#x6790;&#x306E;&#x305F;&#x3081;&#x306E;&#x8A08;&#x91CF;&#x7D4C;&#x6E08;&#x5B66;&#x2015;&#x6B63;&#x3057;&#x3044;&#x624B;&#x6CD5;&#x3068;&#x7D50;&#x679C;&#x306E;&#x8AAD;&#x307F;&#x65B9;</a>&#x300F;&#x4E2D;&#x592E;&#x7D4C;&#x6E08;&#x793E;&#x3001;2015&#xFF0E;<ul>
<li>&#x7B2C;9&#x7AE0; &#x30C8;&#x30FC;&#x30D3;&#x30C3;&#x30C8;&#x30E2;&#x30C7;&#x30EB;&#x3068;&#x30D8;&#x30FC;&#x30AD;&#x30C3;&#x30C8;&#x30E2;&#x30C7;&#x30EB;</li>
</ul>
</li>
<li>&#x672B;&#x77F3;&#x76F4;&#x4E5F;&#x300E;<a href="https://www.nippyo.co.jp/shop/book/6899.html" target="_blank">&#x8A08;&#x91CF;&#x7D4C;&#x6E08;&#x5B66;&#x2015;&#x30DF;&#x30AF;&#x30ED;&#x30C7;&#x30FC;&#x30BF;&#x5206;&#x6790;&#x3078;&#x306E;&#x3044;&#x3056;&#x306A;&#x3044;</a>&#x300F;&#x65E5;&#x672C;&#x8A55;&#x8AD6;&#x793E;&#x3001;2015&#xFF0E;<ul>
<li>&#xA7;6.5 Heckman&#x306E;2&#x6BB5;&#x968E;&#x63A8;&#x5B9A;&#x91CF;</li>
</ul>
</li>
<li>&#x5317;&#x6751;&#x884C;&#x4F38;&#x300E;<a href="https://www.nippyo.co.jp/shop/book/4146.html" target="_blank">&#x30DF;&#x30AF;&#x30ED;&#x8A08;&#x91CF;&#x7D4C;&#x6E08;&#x5B66;&#x5165;&#x9580;</a>&#x300F;&#x65E5;&#x672C;&#x8A55;&#x8AD6;&#x793E;&#x3001;2009&#xFF0E;<ul>
<li>&#x7B2C;10&#x7AE0; &#x30C8;&#x30FC;&#x30D3;&#x30C3;&#x30C8;&#x30FB;&#x30E2;&#x30C7;&#x30EB;&#x3068;&#x30D8;&#x30C3;&#x30AF;&#x30DE;&#x30F3;&#x306E;2&#x6BB5;&#x968E;&#x63A8;&#x5B9A;&#x2015;&#x52B4;&#x50CD;&#x4F9B;&#x7D66;&#x554F;&#x984C; (cf. <a href="http://www.ier.hit-u.ac.jp/~kitamura/lecture/Hit/08Statsys10.pdf" target="_blank">PDF</a>)</li>
</ul>
</li>
<li>Patrick Puhani, <a href="https://doi.org/10.1111/1467-6419.00104" target="_blank">The Heckman Correction for Sample Selection and Its Critique</a>, Journal of Economic Surveys, 14 (1), 53-68, 2000.</li>
<li>Jeffrey M. Wooldridge, <a href="https://mitpress.mit.edu/books/econometric-analysis-cross-section-and-panel-data-second-edition" target="_blank">Econometric Analysis of Cross Section and Panel Data (Second Edition)</a>, MIT Press, 2010.<ul>
<li>Ch. 19 Censored Data, Sample Selection, and Attrition</li>
</ul>
</li>
<li>A. Colin Cameron and Pravin K. Trivedi, <a href="https://www.cambridge.org/core/books/microeconometrics/982158DE989697607C858068ED05C7B1" target="_blank">Microeconometrics Methods and Applications</a>, Cambridge University Press, 2005.<ul>
<li>Section 16.5.4. Heckman Two-Step Estimator</li>
</ul>
</li>
</ul>
<h2 id="&#x524D;&#x63D0;&#x77E5;&#x8B58;">&#x524D;&#x63D0;&#x77E5;&#x8B58;</h2>
<h3 id="&#x5207;&#x65AD;&#x6B63;&#x898F;&#x5206;&#x5E03;">&#x5207;&#x65AD;&#x6B63;&#x898F;&#x5206;&#x5E03;</h3>
<p>&#x6A19;&#x6E96;&#x6B63;&#x898F;&#x5206;&#x5E03;&#x306E;&#x5BC6;&#x5EA6;&#x95A2;&#x6570; <script type="math/tex; ">\phi(z) = \frac{1}{\sqrt{2\pi}} \exp(-\frac{z^2}{2})</script> &#x306B;&#x3064;&#x3044;&#x3066;&#x3001;<script type="math/tex; ">z \ge c</script> &#x306E;&#x5834;&#x5408;&#xFF08;&#x300C;&#x5207;&#x65AD;&#x6B63;&#x898F;&#x5206;&#x5E03;&#x300D;&#xFF09;&#x3092;&#x8003;&#x3048;&#x308B;&#xFF08;&#x3059;&#x306A;&#x308F;&#x3061;&#x3001;<script type="math/tex; ">c</script> &#x672A;&#x6E80;&#x306E; <script type="math/tex; ">z</script> &#x3067;&#x306F; <script type="math/tex; ">\phi(z)=0</script> &#x3068;&#x306A;&#x308B;&#xFF09;&#x3002;</p>
<p><script type="math/tex; "> \int_{c}^{\infty} \phi(z) dz = \Phi(\infty) - \Phi(c) = 1 - \Phi(c) < 1 </script> &#x3068;&#x306A;&#x308B;&#x3002;&#x5B9A;&#x7FA9;&#x4E0A;&#x3001;&#x5BC6;&#x5EA6;&#x95A2;&#x6570;&#x3092;&#x5B9A;&#x7FA9;&#x57DF;&#x3067;&#x7A4D;&#x5206;&#x3059;&#x308B;&#x3068;1&#x306B;&#x306A;&#x3089;&#x306A;&#x3051;&#x308C;&#x3070;&#x306A;&#x3089;&#x306A;&#x3044;&#x306E;&#x3067;&#x3001;&#x5BC6;&#x5EA6;&#x95A2;&#x6570;&#x3092; <script type="math/tex; ">1 - \Phi(c)</script> &#x306E;&#x5206;&#x3060;&#x3051;&#x81A8;&#x3089;&#x307E;&#x305B;&#x3066; <script type="math/tex; "> \frac{\phi(z)}{1 - \Phi(c)} </script> &#x3068;&#x306A;&#x308B;&#x3002;</p>
<p>&#x671F;&#x5F85;&#x5024;&#x3092;&#x8003;&#x3048;&#x308B;&#x3002;</p>
<p><script type="math/tex; "> E[z | z > c]
 = \int_{c}^{\infty} z \frac{\phi(z)}{1 - \Phi(c)} dz
 = \int_{c}^{\infty} z \frac{1}{1 - \Phi(c)} \frac{1}{\sqrt{2\pi}} \exp(-\frac{z^2}{2}) dz </script></p>
<p>&#x3053;&#x3053;&#x3067; <script type="math/tex; "> \frac{d}{dz} \exp(- \frac{z^2}{2}) = - z \exp(- \frac{z^2}{2}) </script> &#x3088;&#x308A;&#x3001;</p>
<p><script type="math/tex; "> \int_{c}^{\infty} z \exp(-\frac{z^2}{2}) dz
 = [- \exp(-\frac{z^2}{2})]_{c}^{\infty}
 = 0 + \exp(- \frac{c^2}{2}) </script></p>
<p>&#x3068;&#x306A;&#x308B;&#x306E;&#x3067;&#x3001;&#x4EE5;&#x4E0B;&#x304C;&#x5F97;&#x3089;&#x308C;&#x308B;&#x3002;</p>
<p><script type="math/tex; "> E[z | z > c]
 = \frac{1}{1 - \Phi(c)} \frac{1}{\sqrt{2\pi}} \int_{c}^{\infty} z \exp(-\frac{z^2}{2}) dz
 = \frac{1}{1 - \Phi(c)} \frac{1}{\sqrt{2\pi}} \exp(- \frac{c^2}{2})
 = \frac{\phi(c)}{1 - \Phi(c)} </script></p>
<p><script type="math/tex; "> E[z | z > -c]
 = \frac{\phi(-c)}{1 - \Phi(-c)}
 = \frac{\phi(c)}{1 - (1 - \Phi(c))}
 = \frac{\phi(c)}{\Phi(c)} </script></p>
<h3 id="&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x30BB;&#x30EC;&#x30AF;&#x30B7;&#x30E7;&#x30F3;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x6982;&#x8981;">&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x30BB;&#x30EC;&#x30AF;&#x30B7;&#x30E7;&#x30F3;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x6982;&#x8981;</h3>
<p>Heckit&#x306F;&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x30BB;&#x30EC;&#x30AF;&#x30B7;&#x30E7;&#x30F3;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x4E00;&#x3064;&#x3068;&#x3057;&#x3066;&#x8AAC;&#x660E;&#x3055;&#x308C;&#x308B;&#x3053;&#x3068;&#x304C;&#x591A;&#x3044;&#x3002;&#x4EE5;&#x4E0B;&#x3001;Cameron and Trivedi (2005, Ch. 16) &#x306B;&#x6CBF;&#x3063;&#x3066;&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x30BB;&#x30EC;&#x30AF;&#x30B7;&#x30E7;&#x30F3;&#x30E2;&#x30C7;&#x30EB;&#x306E;&#x6982;&#x8981;&#x3092;&#x793A;&#x3059;&#x3002;</p>
<p>&#x203B;&#x548C;&#x6587;&#x304B;&#x3064;&#x5FC5;&#x8981;&#x6700;&#x5C0F;&#x9650;&#x306E;&#x8AAC;&#x660E;&#x304C;&#x306A;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3068;&#x3044;&#x3046;&#x6761;&#x4EF6;&#x306E;&#x4E0B;&#x3067;&#x306F;&#x3001;&#x672B;&#x77F3;&#xFF08;2015&#xFF09;&#x304C;&#x5206;&#x304B;&#x308A;&#x3084;&#x3059;&#x305D;&#x3046;&#x3002;</p>
<p>&#x88AB;&#x8AAC;&#x660E;&#x5909;&#x6570;&#x306E;&#x5024;&#x306B;&#x3088;&#x3063;&#x3066;&#x30B5;&#x30F3;&#x30D7;&#x30EA;&#x30F3;&#x30B0;&#x3055;&#x308C;&#x308B;&#x5834;&#x5408;&#x3001;&#x56DE;&#x5E30;&#x30E2;&#x30C7;&#x30EB;&#xFF08;&#x306A;&#x3069;&#x306E;&#x7D71;&#x8A08;&#x30E2;&#x30C7;&#x30EB;&#xFF09;&#x306E;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306F;&#x4E00;&#x81F4;&#x63A8;&#x5B9A;&#x91CF;&#x3067;&#x306F;&#x306A;&#x304F;&#x306A;&#x308B;&#x5834;&#x5408;&#x304C;&#x3042;&#x308B;&#x3002;&#x3053;&#x306E;&#x3068;&#x304D;&#x3001;&#x4E00;&#x81F4;&#x63A8;&#x5B9A;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;&#x306F;&#x4F55;&#x3089;&#x304B;&#x306E;&#x88DC;&#x6B63;&#x3092;&#x4E0E;&#x3048;&#x308B;&#x5FC5;&#x8981;&#x304C;&#x751F;&#x3058;&#x308B;&#x3002;&#x3053;&#x306E;&#x3088;&#x3046;&#x306A;&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x306F;&#x5E83;&#x304F; selected sample &#x3068;&#x3057;&#x3066;&#x5B9A;&#x7FA9;&#x3055;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;&#x3069;&#x306E;&#x3088;&#x3046;&#x306B; select &#x3055;&#x308C;&#x308B;&#x304B;&#x306F;&#x30B1;&#x30FC;&#x30B9;&#x30D0;&#x30A4;&#x30B1;&#x30FC;&#x30B9;&#x306A;&#x306E;&#x3067;&#xFF08;&#x4F8B;&#xFF1A;self-selection&#xFF09;&#x3001;&#x305D;&#x308C;&#x3089;&#x306B;&#x5BFE;&#x5FDC;&#x3057;&#x305F;&#x6570;&#x591A;&#x304F;&#x306E; selection model &#x304C;&#x5B58;&#x5728;&#x3059;&#x308B;&#x3002;</p>
<ul>
<li>Tobit [type 1 Tobit] ... Section 16.3</li>
<li>Bivariate sample selection model [type 2 Tobit] ... Section 16.5</li>
<li>Roy model [type 5 Tobit] ... Section 16.7</li>
</ul>
<h3 id="tobit&#x30E2;&#x30C7;&#x30EB;-ct05-&#xA7;-163">Tobit&#x30E2;&#x30C7;&#x30EB; [CT05, &#xA7; 16.3]</h3>
<p>Tobit&#x30E2;&#x30C7;&#x30EB; (censored normal regression model) &#x306F;&#x3001;&#x6F5C;&#x5728;&#x5909;&#x6570; (latent variable) &#x304C;0&#x4EE5;&#x4E0B;&#x3067; censoring &#xFF08;&#x6253;&#x3061;&#x5207;&#x308A;&#xFF09;&#x3055;&#x308C;&#x308B;&#x30B1;&#x30FC;&#x30B9;&#x306E;&#x4E00;&#x3064;&#x3002;</p>
<p><script type="math/tex; "> y^{*} = \mathbf{x}' \beta + \epsilon, \quad \epsilon \sim N(0, \sigma^2), \quad y =
\begin{cases} y^{*} \quad \text{if } y^{*} > 0 \\
. \text{ (missing)} \quad \text{if } y^{*} \le 0 \end{cases} </script></p>
<p>&#x3053;&#x3053;&#x3067;&#x3057;&#x308C;&#x3063;&#x3068; <script type="math/tex; "> \epsilon \sim N </script> &#x3092;&#x4EEE;&#x5B9A;&#x3057;&#x3066;&#x3044;&#x308B;&#x304C;&#x3001;&#x3053;&#x308C;&#x304C;&#x6E80;&#x305F;&#x3055;&#x308C;&#x306A;&#x3044;&#x5834;&#x5408;&#x306B;&#x4EE5;&#x4E0B;&#x306E;&#x8B70;&#x8AD6;&#x3092;&#x9069;&#x7528;&#x3059;&#x308B;&#x3053;&#x3068;&#x306F;&#x9069;&#x5F53;&#x3067;&#x306A;&#x3044;&#x3002;&#x305D;&#x308C;&#x306F;&#x307E;&#x305F;&#x5225;&#x306E;&#x8A71; (control function approach by Lung-Fei Lee; Gordon Dahl)&#x3002;</p>
<p>&#x306A;&#x304A;&#x3001;&#x6253;&#x3061;&#x5207;&#x308A; (censoring) &#x3068;&#x5207;&#x65AD; (truncation) &#x306F;&#x7570;&#x306A;&#x308B;&#x70B9;&#x306B;&#x6CE8;&#x610F;&#x3002;&#x5207;&#x65AD;&#x3055;&#x308C;&#x305F;&#x5206;&#x306F;&#x30C7;&#x30FC;&#x30BF;&#x304C;&#x89B3;&#x6E2C;&#x3055;&#x308C;&#x306A;&#x3044;&#x304C;&#x3001;&#x6253;&#x3061;&#x5207;&#x308A;&#x306F;&#x30C7;&#x30FC;&#x30BF;&#x304C;&#x95BE;&#x5024;&#x306B;&#x5F35;&#x308A;&#x4ED8;&#x304F; (spike)&#x3002;</p>
<p>0&#x3088;&#x308A;&#x5DE6;&#x5074;&#x304C;&#x5207;&#x65AD;&#x3055;&#x308C; (left truncation at zero)&#x3001;<script type="math/tex; "> y^{*} > 0 </script> &#x306E;&#x5834;&#x5408;&#x306B; <script type="math/tex; ">y</script> &#x304C;&#x89B3;&#x6E2C;&#x3055;&#x308C;&#x308B;&#x5834;&#x5408;&#x3092;&#x8003;&#x3048;&#x308B;&#x3002;</p>
<p><script type="math/tex; "> \begin{align} E[y]
 & = E[y^{*} | y^{*} > 0]
 = E[\mathbf{x}' \beta + \epsilon | \mathbf{x}' \beta + \epsilon > 0] \\
 & = E[\mathbf{x}' \beta | \mathbf{x}' \beta + \epsilon > 0] + E[\epsilon | \mathbf{x}' \beta + \epsilon > 0]
 = \mathbf{x}' \beta + E[\epsilon | \epsilon > - \mathbf{x}' \beta]
 \end{align} </script></p>
<p>&#x3053;&#x3053;&#x3067;&#x3001;<script type="math/tex; "> E[\mathbf{x}' \beta | \mathbf{x}' \beta + \epsilon > 0] = \mathbf{x}' \beta </script> &#x306F; <script type="math/tex; "> \mathbf{x} </script> &#x3068; <script type="math/tex; "> \epsilon </script> &#x306E;&#x72EC;&#x7ACB;&#x6027;&#x3088;&#x308A;&#xFF08;<script type="math/tex; "> \mathbf{x}' \beta </script> &#x90E8;&#x5206;&#x3092;&#x5B9A;&#x6570;&#x306E;&#x3088;&#x3046;&#x306B;&#x8003;&#x3048;&#x308C;&#x3070;&#x3088;&#x3044;&#xFF09;&#x3002;</p>
<p><script type="math/tex; "> E[\epsilon | \epsilon > - \mathbf{x}' \beta]
 = \sigma E[\frac{\epsilon}{\sigma} | \frac{\epsilon}{\sigma} > - \frac{\mathbf{x}' \beta}{\sigma}]
 = \sigma \frac{\phi(\mathbf{x}' \beta / \sigma)}{\Phi(\mathbf{x}' \beta / \sigma)}
 = \sigma \lambda (\frac{\mathbf{x}' \beta}{\sigma})
</script></p>
<p>&#x3053;&#x306E; <script type="math/tex; "> \lambda (z) = \frac{\phi(z)}{\Phi(z)} </script> &#x306F;&#x9006;&#x30DF;&#x30EB;&#x30BA;&#x6BD4; (inverse Mills ratio) &#x3068;&#x547C;&#x3070;&#x308C;&#x308B;&#x3002;&#x5927;&#x5143;&#x306E;&#x63D0;&#x6848;&#x8005;&#x3067;&#x3042;&#x308B; <a href="https://doi.org/10.1093/biomet/18.3-4.395" target="_blank">John Mills (Biometrika 1926)</a> &#x306F;&#x3053;&#x306E;&#x9006;&#x6570;&#x3067;&#x3042;&#x308B; <script type="math/tex; "> \frac{1 - \Phi(z)}{\phi(z)} = \frac{\Phi(-z)}{\phi(z)} </script> &#x3092;&#x7528;&#x3044;&#x3066;&#x3044;&#x305F;&#x305F;&#x3081;&#x3001;&#x300C;&#x9006;&#x300D;&#x30DF;&#x30EB;&#x30BA;&#x6BD4;&#x3002;&#x3053;&#x306E;&#x7406;&#x7531;&#x304B;&#x3089;&#x3001;&#x4E00;&#x90E8;&#x306E;&#x30C6;&#x30AD;&#x30B9;&#x30C8;&#x3067;&#x306F; <script type="math/tex; "> \lambda^{*}(z) = \frac{\Phi(-z)}{\phi(z)} </script> &#x3092;&#x9006;&#x30DF;&#x30EB;&#x30BA;&#x6BD4;&#x3068;&#x547C;&#x3076;&#x3089;&#x3057;&#x3044;&#x3002;</p>
<p>&#x4EE5;&#x4E0A;&#x3088;&#x308A; <script type="math/tex; "> E[y | \mathbf{x}, y > 0] = \mathbf{x}' \beta + \sigma \phi(\frac{\mathbf{x}' \beta}{\sigma}) </script> &#x304C;&#x5F97;&#x3089;&#x308C;&#x308B;&#x3002;</p>
<p>&#x5C0E;&#x51FA;&#x306F;&#x8FFD;&#x308F;&#x306A;&#x3044;&#x304C;&#x3001;&#x9650;&#x754C;&#x52B9;&#x679C;&#x306F;&#x4EE5;&#x4E0B;&#x306E;&#x3068;&#x304A;&#x308A;&#x3002;</p>
<p><script type="math/tex; "> \frac{\partial}{\partial \mathbf{x}} E[y | \mathbf{x}, y > 0 ] = [1 - \frac{\mathbf{x}' \beta}{\sigma} \lambda (\frac{\mathbf{x}' \beta}{\sigma}) - \lambda (\frac{\mathbf{x}' \beta}{\sigma})^2] \beta </script></p>
<p>&#x63A8;&#x5B9A;&#x65B9;&#x6CD5;&#x306B;&#x306F;&#x3001;&#x6700;&#x5C24;&#x6CD5;&#x3001;&#x975E;&#x7DDA;&#x5F62;&#x6700;&#x5C0F;&#x4E8C;&#x4E57;&#x6CD5;&#x3001;Heckman&#x306E;2&#x6BB5;&#x968E;&#x63A8;&#x5B9A;&#x3001;&#x306A;&#x3069;&#x304C;&#x3042;&#x308B;&#x3002;Heckman&#x306E;2&#x6BB5;&#x968E;&#x63A8;&#x5B9A;&#x306B;&#x3064;&#x3044;&#x3066;&#x3001;&#x8A73;&#x7D30;&#x306F;&#x5F8C;&#x8FF0;&#x3059;&#x308B;&#x304C;&#x3001;&#x6982;&#x8981;&#x306F;&#x6B21;&#x306E;&#x901A;&#x308A;&#x3002;</p>
<ul>
<li>&#x7B2C;1&#x6BB5;&#x968E;&#xFF1A;Full sample &#x3067; <script type="math/tex; ">d (\equiv 1(y>0))</script> &#x3092; <script type="math/tex; "> \mathbf{x} </script> &#x306B;&#x56DE;&#x5E30;&#x3059;&#x308B;&#x30D7;&#x30ED;&#x30D3;&#x30C3;&#x30C8;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x63A8;&#x8A08;&#x3057;&#x3001;<script type="math/tex; "> \alpha = \beta/\sigma </script> &#x306E;&#x4E00;&#x81F4;&#x63A8;&#x5B9A;&#x91CF; <script type="math/tex; "> \hat{\alpha} </script> &#x3092;&#x5F97;&#x308B;</li>
<li>&#x7B2C;2&#x6BB5;&#x968E;&#xFF1A;Truncated sample &#x3067; <script type="math/tex; ">y</script> &#x3092; <script type="math/tex; "> \mathbf{x}, \lambda(\mathbf{x}' \hat{\alpha}) </script> &#x306B;&#x56DE;&#x5E30;&#x3057;&#x3001;<script type="math/tex; "> \beta, \sigma </script> &#x306E;&#x4E00;&#x81F4;&#x63A8;&#x5B9A;&#x91CF;&#x3092;&#x5F97;&#x308B;</li>
</ul>
<h3 id="a-bivariate-sample-selection-model-type-2-tobit-ct05-&#xA7;-1652">A Bivariate Sample Selection Model (Type 2 Tobit) [CT05, &#xA7; 16.5.2]</h3>
<p>2&#x5909;&#x91CF;&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x30BB;&#x30EC;&#x30AF;&#x30B7;&#x30E7;&#x30F3;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x8003;&#x3048;&#x308B;&#x3002;</p>
<p>&#x30A2;&#x30A6;&#x30C8;&#x30AB;&#x30E0;&#x3092; <script type="math/tex; "> y^{*}_{2} </script> &#x3068;&#x8A18;&#x3059;&#x3002;&#x6A19;&#x6E96;&#x7684;&#x306A;&#x5207;&#x65AD;Tobit&#x30E2;&#x30C7;&#x30EB;&#x3067;&#x306F;&#x3001;&#x3053;&#x306E;&#x30A2;&#x30A6;&#x30C8;&#x30AB;&#x30E0;&#x306F; <script type="math/tex; "> y^{*}_{2} > 0 </script> &#x306E;&#x5834;&#x5408;&#x306B;&#x89B3;&#x6E2C;&#x3055;&#x308C;&#x308B;&#x3002;&#x3088;&#x308A;&#x4E00;&#x822C;&#x5316;&#x3057;&#x3066;&#x3001;&#x3053;&#x308C;&#x3068;&#x306F;&#x5225;&#x306E;&#x6F5C;&#x5728;&#x5909;&#x6570; <script type="math/tex; "> y^{*}_{1} </script> &#x3092;&#x5C0E;&#x5165;&#x3057;&#x3066;&#x3001;<script type="math/tex; "> y^{*}_{1} > 0 </script> &#x306E;&#x5834;&#x5408;&#x306B;&#x30A2;&#x30A6;&#x30C8;&#x30AB;&#x30E0; <script type="math/tex; "> y^{*}_{2} </script> &#x304C;&#x89B3;&#x6E2C;&#x3055;&#x308C;&#x308B;&#x3082;&#x306E;&#x3068;&#x3057;&#x3088;&#x3046;&#x3002;</p>
<p>&#x4F8B;&#xFF1A;</p>
<ul>
<li><script type="math/tex; "> y^{*}_{1} </script>: &#x5C31;&#x52B4;&#x3057;&#x3066;&#x3044;&#x308B;&#x304B;&#x3069;&#x3046;&#x304B;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x6F5C;&#x5728;&#x5909;&#x6570;</li>
<li><script type="math/tex; "> y^{*}_{2} </script>: &#x3069;&#x308C;&#x3060;&#x3051;&#x52B4;&#x50CD;&#x3057;&#x3066;&#x3044;&#x308B;&#x304B;&#xFF08;&#x52B4;&#x50CD;&#x6642;&#x9593;&#xFF09;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x6F5C;&#x5728;&#x5909;&#x6570;</li>
<li>&#x5C31;&#x52B4;&#x306B;&#x306F;&#x901A;&#x52E4;&#x30B3;&#x30B9;&#x30C8;&#x306A;&#x3069;&#x306E;&#x56FA;&#x5B9A;&#x30B3;&#x30B9;&#x30C8;&#xFF08;&#x3069;&#x308C;&#x3060;&#x3051;&#x306E;&#x6642;&#x9593;&#x50CD;&#x304F;&#x304B;&#x3088;&#x308A;&#x3082;&#x3001;&#x5C31;&#x52B4;&#x3059;&#x308B;&#x304B;&#x3069;&#x3046;&#x304B;&#x3092;&#x6C7A;&#x5B9A;&#x3059;&#x308B;&#x306E;&#x306B;&#x3088;&#x308A;&#x91CD;&#x8981;&#x3068;&#x601D;&#x308F;&#x308C;&#x308B;&#x3002;&#xFF09;&#x304C;&#x304B;&#x304B;&#x308B;&#x305F;&#x3081;&#x3001;<script type="math/tex; "> y^{*}_{1} \ne y^{*}_{2} </script> &#x3067;&#x3042;&#x308B;&#x3002;</li>
</ul>
<p>&#x30E2;&#x30C7;&#x30EB;&#x306F;&#x4EE5;&#x4E0B;&#x306E;2&#x3064;&#x306E;&#x5F0F;&#x304B;&#x3089;&#x306A;&#x308B;&#x3002;</p>
<ul>
<li>participation equation: <script type="math/tex; "> y_1 = \begin{cases} 1 \quad \text{if} \ y_{1}^{*} > 0 \\ 0 \quad \text{if} \ y_{1}^{*} \le 0 \end{cases} </script></li>
<li>outcome equation: <script type="math/tex; "> y_2 = \begin{cases} y_{2}^{*} \quad \text{if} \ y_{1}^{*} > 0 \\ . \ \text{(missing)} \quad \text{if} \ y_{1}^{*} \le 0 \end{cases} </script></li>
</ul>
<p>&#x6A19;&#x6E96;&#x7684;&#x306A;&#x7279;&#x5B9A;&#x5316;&#x306F;&#x3001;&#x6F5C;&#x5728;&#x5909;&#x6570;&#x306E;&#x9805;&#x306B;&#x8AA4;&#x5DEE;&#x9805;&#x3092;&#x8DB3;&#x3059;&#x3082;&#x306E;&#x3002;&#x306A;&#x304A;&#x3001;Tobit&#x306F; <script type="math/tex; "> y_{1}^{*} = y_{2}^{*} </script> &#x306E;&#x7279;&#x6B8A;&#x30B1;&#x30FC;&#x30B9;&#x306B;&#x76F8;&#x5F53;&#x3059;&#x308B;&#x3002;</p>
<ul>
<li><script type="math/tex; "> y_{1}^{*} = \mathbf{x}'_1 \beta_1 + \epsilon_1 </script></li>
<li><script type="math/tex; "> y_{2}^{*} = \mathbf{x}'_2 \beta_2 + \epsilon_2 </script></li>
</ul>
<p><script type="math/tex; "> \epsilon_1, \epsilon_2 </script> &#x304C;&#x76F8;&#x95A2;&#x3057;&#x3066;&#x3044;&#x308B;&#x5834;&#x5408;&#x306B; <script type="math/tex; "> \beta_2 </script> &#x3092;&#x4E00;&#x81F4;&#x63A8;&#x5B9A;&#x3067;&#x304D;&#x306A;&#x304F;&#x306A;&#x308B;&#x3053;&#x3068;&#x304C;&#x554F;&#x984C;&#x3002;</p>
<p>&#x3053;&#x306E;&#x30E2;&#x30C7;&#x30EB;&#x306B;&#x6C7A;&#x307E;&#x3063;&#x305F;&#x547C;&#x3073;&#x65B9;&#x306F;&#x306A;&#x3044;&#x304C;&#x3001;Tobit model with stochastic threshold, type 2 Tobit model, probit selection equation, generalized Tobit model, sample selection model &#x306A;&#x3069;&#x3068;&#x547C;&#x3070;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;</p>
<p>&#x6700;&#x5C24;&#x63A8;&#x5B9A;&#x306E;&#x305F;&#x3081;&#x306B;&#x306F;&#x3001;&#x8AA4;&#x5DEE;&#x9805;&#x304C;&#xFF08;&#x4E0D;&#x5747;&#x4E00;&#x5206;&#x6563;&#x306E;&#xFF09;&#x540C;&#x6642;&#x6B63;&#x898F;&#x5206;&#x5E03;&#x306B;&#x5F93;&#x3046;&#x3068;&#x4EEE;&#x5B9A;&#x3059;&#x308B;&#xFF08;<script type="math/tex; "> \sigma_{1}^{2} = 1 </script> &#x306B;normalize&#xFF09;&#x3002;</p>
<p><script type="math/tex; "> \begin{bmatrix} \epsilon_1 \\ \epsilon_2 \end{bmatrix} = N \left[
 \begin{bmatrix} 0 \\ 0 \end{bmatrix},
 \begin{bmatrix} 1 & \sigma_{12} \\ \sigma_{12} & \sigma_{2}^{2} \end{bmatrix}
\right] </script></p>
<p>&#x5C24;&#x5EA6;&#x95A2;&#x6570;&#x306F;&#x6B21;&#x306E;&#x901A;&#x308A;&#x3002;&#x3053;&#x308C;&#x306F;&#x540C;&#x6642;&#x6B63;&#x898F;&#x8AA4;&#x5DEE;&#x3092;&#x6301;&#x3064;&#x7DDA;&#x5F62;&#x30E2;&#x30C7;&#x30EB;&#x306B;&#x9650;&#x5B9A;&#x3055;&#x308C;&#x306A;&#x3044;&#x3001;&#x3088;&#x308A;&#x4E00;&#x822C;&#x5316;&#x3055;&#x308C;&#x305F;&#x5C24;&#x5EA6;&#x95A2;&#x6570;&#x306B;&#x306A;&#x3063;&#x3066;&#x3044;&#x308B;&#x3002;</p>
<p><script type="math/tex; "> L = \prod_{i = 1}^{n} \{ \text{Pr}[y_{1i}^{*} \le 0]^{1 - y_{1i}} \} \{ f(y_{2i} | y_{1i}^{*} > 0) \times \text{Pr}[y_{1i}^{*} > 0] \}^{y_{1i}} </script></p>
<p>&#x6700;&#x521D;&#x306E;&#x9805;&#x306F; <script type="math/tex; "> y_{1i}^{*} \le 0 </script> &#x306E;&#x5834;&#x5408;&#x306E;&#x96E2;&#x6563;&#x90E8;&#x5206;&#x306B;&#x5BFE;&#x5FDC;&#x3057;&#x3001;2&#x3064;&#x76EE;&#x306E;&#x9805;&#x306F; <script type="math/tex; "> y_{1i}^{*} > 0 </script> &#x306E;&#x5834;&#x5408;&#x306E;&#x9023;&#x7D9A;&#x90E8;&#x5206;&#x306B;&#x5BFE;&#x5FDC;&#x3059;&#x308B;&#x3002;</p>
<h3 id="conditional-means-in-the-bivariate-sample-selection-model-ct05-&#xA7;-1653">Conditional Means in the Bivariate Sample Selection Model [CT05, &#xA7; 16.5.3]</h3>
<p><script type="math/tex; "> y_2 </script> &#x3092; <script type="math/tex; "> \mathbf{x}_2 </script> &#x306B;&#x56DE;&#x5E30;&#x3057;&#x305F;&#x5834;&#x5408;&#xFF08;OLS&#x63A8;&#x5B9A;&#xFF09;&#x3001;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;&#x4E00;&#x81F4;&#x63A8;&#x5B9A;&#x91CF;&#x306F;&#x5F97;&#x3089;&#x308C;&#x306A;&#x3044;&#x3002;&#x4E00;&#x65B9;&#x3067;&#x524D;&#x8FF0;&#x306E;&#x5C24;&#x5EA6;&#x95A2;&#x6570;&#x3092;&#x7528;&#x3044;&#x305F;&#x6700;&#x5C24;&#x63A8;&#x5B9A;&#x306F;&#x5236;&#x7D04;&#x304C;&#x5F37;&#x3044;&#x305F;&#x3081;&#x3001;&#x5225;&#x306E;&#x63A8;&#x5B9A;&#x65B9;&#x6CD5;&#x3092;&#x5229;&#x7528;&#x3057;&#x305F;&#x3044;&#x3002;&#x305D;&#x306E;&#x305F;&#x3081;&#x306B;&#x3001;&#x307E;&#x305A;&#x306F; conditional mean &#x3092;&#x8003;&#x3048;&#x308B;&#x3002;</p>
<p>&#x5207;&#x65AD;&#x3055;&#x308C;&#x305F;&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x306E;&#x5E73;&#x5747;&#x3092;&#x8003;&#x3048;&#x308B;&#xFF08;<script type="math/tex; "> \mathbf{x} \text{: union of } \mathbf{x}_1, \mathbf{x}_2 </script>&#xFF09;&#x3002;</p>
<p><script type="math/tex; "> E[y_2 | \mathbf{x}, y_1^{*} > 0]
 = E[\mathbf{x}_2' \beta_2 + \epsilon_2 | \mathbf{x}_1' \beta_1 + \epsilon_1 > 0]
 = \mathbf{x}_2' \beta_2 + E[\epsilon_2 | \epsilon_1 > - \mathbf{x}_1' \beta_1] </script></p>
<p> &#x8AA4;&#x5DEE;&#x9805; <script type="math/tex; "> \epsilon_1, \epsilon_2 </script> &#x304C;&#x72EC;&#x7ACB;&#x3067;&#x3042;&#x308C;&#x3070; <script type="math/tex; "> E[\epsilon_2 | \epsilon_1 > - \mathbf{x}_1' \beta_1] = E[\epsilon_2] = 0 </script> &#x306A;&#x306E;&#x3067;&#x3001;<script type="math/tex; "> y_2 </script> &#x3092; <script type="math/tex; "> \mathbf{x}_2 </script> &#x306B;&#x56DE;&#x5E30;&#x3059;&#x308C;&#x3070;&#xFF08;OLS&#x63A8;&#x5B9A;&#xFF09;&#x3001;<script type="math/tex; "> \beta_2 </script> &#x3092;&#x4E00;&#x81F4;&#x63A8;&#x5B9A;&#x3067;&#x304D;&#x308B;&#x3002;&#x4EE5;&#x4E0B;&#x3001;&#x72EC;&#x7ACB;&#x3067;&#x306A;&#x3044;&#x5834;&#x5408;&#x3092;&#x8003;&#x3048;&#x308B;&#x3002;</p>
<p><a href="https://www.jstor.org/stable/1912352" target="_blank">Heckman (ECTA 1979)</a> &#x306F;&#x3001;&#x8AA4;&#x5DEE;&#x9805; <script type="math/tex; "> \epsilon_1, \epsilon_2 </script> &#x304C;&#x540C;&#x6642;&#x6B63;&#x898F;&#x5206;&#x5E03;&#x306B;&#x5F93;&#x3046;&#x5834;&#x5408;&#x306B;&#x4EE5;&#x4E0B;&#x304C;&#x5F97;&#x3089;&#x308C;&#x308B;&#x3053;&#x3068;&#x3092;&#x793A;&#x3057;&#x305F;&#x3002;</p>
<p><script type="math/tex; "> \epsilon_2 = \sigma_{12} \epsilon_1 + \xi, \quad \epsilon_1 \perp \!\!\! \perp \xi </script></p>
<p>&#x3053;&#x308C;&#x306F;&#x3001;&#x540C;&#x6642;&#x6B63;&#x898F;&#x5206;&#x5E03;&#x3092;&#x4EEE;&#x5B9A;&#x3057;&#x305F;&#x5834;&#x5408;&#x306E;&#x6761;&#x4EF6;&#x4ED8;&#x5E73;&#x5747;&#x304B;&#x3089;&#x5C0E;&#x304B;&#x308C;&#x308B;&#x3002;</p>
<blockquote>
<p><script type="math/tex; "> \begin{bmatrix} \mathbf{z}_1 \\ \mathbf{z}_2 \end{bmatrix} \sim N \left[
  \begin{bmatrix} \boldsymbol{\mu}_1 \\ \boldsymbol{\mu}_2 \end{bmatrix},
  \begin{bmatrix} \Sigma_{11} & \Sigma_{12} \\ \Sigma_{21} & \Sigma_{22} \end{bmatrix} \right] </script></p>
<p><script type="math/tex; "> \mathbf{z}_2 | \mathbf{z}_1 \sim N [\boldsymbol{\mu}_2 + \Sigma_{21} \Sigma_{11}^{-1} (\mathbf{z}_1 - \boldsymbol{\mu}_1), \Sigma_{22} - \Sigma_{21} \Sigma_{11}^{-1} \Sigma_{12}] </script></p>
<p><script type="math/tex; "> \mathbf{z}_2 = \boldsymbol{\mu}_2 + \Sigma_{21} \Sigma_{11}^{-1} (\mathbf{z}_1 - \boldsymbol{\mu}_1) + \boldsymbol{\xi}, \quad
 \boldsymbol{\xi} \sim N [\mathbf{0}, \Sigma_{22} - \Sigma_{21} \Sigma_{11}^{-1} \Sigma_{12}], \quad
 \boldsymbol{\xi} \perp \!\!\! \perp \mathbf{z}_1 </script></p>
</blockquote>
<p>&#x3053;&#x308C;&#xFF08;<script type="math/tex; "> \epsilon_2 = \sigma_{12} \epsilon_1 + \xi </script>&#xFF09;&#x3092;&#x9069;&#x7528;&#x3059;&#x308B;&#x3068;&#x3001;&#x4EE5;&#x4E0B;&#x304C;&#x5F97;&#x3089;&#x308C;&#x308B;&#x3002;&#x6700;&#x5F8C;&#x306E;&#x7B49;&#x5F0F;&#x306F; <script type="math/tex; "> \xi \perp \!\!\! \perp \epsilon_1 </script> &#x3088;&#x308A;&#x3002;</p>
<p><script type="math/tex; "> \begin{align} E[y_2 | \mathbf{x}, y_1^{*} > 0]
 & = \mathbf{x}_2' \beta_2 + E[\epsilon_2 | \epsilon_1 > - \mathbf{x}_1' \beta_1]
 = \mathbf{x}_2' \beta_2 + E[\sigma_{12} \epsilon_1 + \xi | \epsilon_1 > - \mathbf{x}_1' \beta_1] \\
 & = \mathbf{x}_2' \beta_2 + \sigma_{12} E[\epsilon_1 | \epsilon_1 > - \mathbf{x}_1' \beta_1] \end{align} </script></p>
<p>&#x9006;&#x30DF;&#x30EB;&#x30BA;&#x6BD4;&#x306F; <script type="math/tex; "> E[z | z > -c] = \lambda(c) = \frac{\phi(z)}{\Phi(z)} </script> &#x306A;&#x306E;&#x3067;&#x3001;&#x4EE5;&#x4E0B;&#x3068;&#x306A;&#x308B;&#x3002;</p>
<p><script type="math/tex; "> E[y_2 | \mathbf{x}, y_1^{*} > 0] = \mathbf{x}_2' \beta_2 + \sigma_{12} \lambda(\mathbf{x}_1' \beta_1) </script></p>
<h2 id="&#x3088;&#x3046;&#x3084;&#x304F;&#x672C;&#x984C;&#x3001;heckman-two-step-estimator-ct05-&#xA7;-1654">&#x3088;&#x3046;&#x3084;&#x304F;&#x672C;&#x984C;&#x3001;Heckman Two-Step Estimator [CT05, &#xA7; 16.5.4]</h2>
<p><script type="math/tex; "> y_2 </script> &#x304C;&#x6B63;&#x306E;&#x5024;&#x3092;&#x3068;&#x308B;&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x306E;&#x307F;&#x3067; <script type="math/tex; "> y_2 </script> &#x3092; <script type="math/tex; "> \mathbf{x}_2 </script> &#x306B;&#x56DE;&#x5E30;&#x3059;&#x308B;&#x3068;&#xFF08;OLS&#x63A8;&#x5B9A;&#xFF09;&#x3001;<script type="math/tex; "> \sigma_{12} = 0 </script> &#x3067;&#x306A;&#x3044;&#x9650;&#x308A;&#x306F; <script type="math/tex; "> \beta </script> &#x306E;&#x4E00;&#x81F4;&#x63A8;&#x5B9A;&#x304C;&#x3067;&#x304D;&#x306A;&#x3044;&#x3002;</p>
<p>Heckman&apos;s two-step procedure &#x307E;&#x305F;&#x306F; Heckit estimator &#x3067;&#x306F;&#x3001;&#x9664;&#x5916;&#x5909;&#x6570; <script type="math/tex; "> \lambda (\mathbf{x}_1' \beta_1) </script> &#x3092;&#x8FFD;&#x52A0;&#x3057;&#x3066;&#x56DE;&#x5E30;&#x3092;&#x884C;&#x3046;&#xFF08;OLS&#x63A8;&#x5B9A;&#xFF09;&#x3002;&#x3059;&#x306A;&#x308F;&#x3061;&#x3001;<script type="math/tex; "> y_2 </script> &#x304C;&#x6B63;&#x306E;&#x5024;&#x3092;&#x6301;&#x3064;&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x306B;&#x5927;&#x3057;&#x3066;&#x3001;&#x6B21;&#x306E;&#x30E2;&#x30C7;&#x30EB;&#x3092;OLS&#x63A8;&#x5B9A;&#x3059;&#x308B;&#x3002;</p>
<p><script type="math/tex; "> y_{2i} = \mathbf{x}_{2i}' \beta_2 + \sigma_{12} \lambda(\mathbf{x}_{1i}' \hat{\beta}_1) + v_i </script></p>
<ul>
<li><script type="math/tex; "> v </script>: &#x8AA4;&#x5DEE;&#x9805;</li>
<li><script type="math/tex; "> \hat{\beta}_1 </script>: &#x7B2C;1&#x6BB5;&#x968E;&#x306E;&#x30D7;&#x30ED;&#x30D3;&#x30C3;&#x30C8;&#x56DE;&#x5E30;&#xFF08;<script type="math/tex; "> y_1 </script> &#x3092; <script type="math/tex; "> \mathbf{x}_1 </script> &#x306B;&#x56DE;&#x5E30;, <script type="math/tex; "> \text{Pr}[y_1^{*} > 0] = \Phi(\mathbf{x}_1' \beta_1) </script>&#xFF09;&#x306B;&#x3088;&#x3063;&#x3066;&#x5F97;&#x3089;&#x308C;&#x305F;&#x30D1;&#x30E9;&#x30E1;&#x30FC;&#x30BF;&#x306E;&#x63A8;&#x5B9A;&#x91CF;</li>
<li><script type="math/tex; "> \lambda(\mathbf{x}_{1}' \hat{\beta}_1) = \phi/\Phi </script>: &#x63A8;&#x5B9A;&#x3055;&#x308C;&#x305F;&#x9006;&#x30DF;&#x30EB;&#x30BA;&#x6BD4;</li>
<li><script type="math/tex; "> H_0: \sigma_{12} = 0 </script> &#x306F;Wald&#x691C;&#x5B9A;&#x306A;&#x3069;&#x306B;&#x3088;&#x3063;&#x3066;&#x691C;&#x5B9A;&#x3059;&#x308B;&#x3053;&#x3068;&#x304C;&#x3067;&#x304D;&#x308B;</li>
</ul>
<p>&#x305F;&#x3060;&#x3057;&#x3001;&#x901A;&#x5E38;&#x306E;&#x6A19;&#x6E96;&#x8AA4;&#x5DEE;&#x3082; heteroskedasticity-robust &#x6A19;&#x6E96;&#x8AA4;&#x5DEE;&#x3082;&#x6B63;&#x78BA;&#x3067;&#x306F;&#x306A;&#x3044;&#x70B9;&#x306B;&#x6CE8;&#x610F;&#x3059;&#x308B;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x308B;&#x3002;&#x6B63;&#x78BA;&#x306A;&#x6A19;&#x6E96;&#x8AA4;&#x5DEE;&#x3092;&#x5C0E;&#x51FA;&#x3059;&#x308B;&#x305F;&#x3081;&#x306B;&#x306F;&#x3001;(1) &#x8AA4;&#x5DEE;&#x9805; <script type="math/tex; ">v</script> &#x304C;&#x4E0D;&#x5747;&#x4E00;&#x5206;&#x6563;&#x3092;&#x6301;&#x3064;&#x3053;&#x3068;&#x3001;&#x304A;&#x3088;&#x3073;&#x3001;(2) <script type="math/tex; "> \beta_1 </script> &#x306F;&#x63A8;&#x5B9A;&#x5024;&#x3067;&#x7F6E;&#x304D;&#x63DB;&#x3048;&#x3089;&#x308C;&#x308B;&#x3053;&#x3068;&#x3001;&#x306E;2&#x70B9;&#x3092;&#x8003;&#x616E;&#x3059;&#x308B;&#x5FC5;&#x8981;&#x304C;&#x3042;&#x308B;&#x3002;&#x8A08;&#x7B97;&#x306F;&#x8907;&#x96D1;&#x306A;&#x306E;&#x3067;&#x3001;&#x7D71;&#x8A08;&#x30D1;&#x30C3;&#x30B1;&#x30FC;&#x30B8;&#x306B;&#x8A08;&#x7B97;&#x3055;&#x305B;&#x308B;&#x304B;&#x3001;&#x3042;&#x308B;&#x3044;&#x306F;&#x30D6;&#x30FC;&#x30C8;&#x30B9;&#x30C8;&#x30E9;&#x30C3;&#x30D7;&#x6CD5;&#x3067;&#x8A08;&#x7B97;&#x3059;&#x308B;&#x306E;&#x304C;&#x30D9;&#x30BF;&#x30FC;&#x3002;</p>
<p>&#x6700;&#x5C24;&#x63A8;&#x5B9A;&#x3059;&#x308B;&#x5834;&#x5408;&#x3068;&#x6BD4;&#x3079;&#x3066; efficiency loss &#x304C;&#x3042;&#x308B;&#x3082;&#x306E;&#x306E;&#x3001;(1) &#x5B9F;&#x88C5;&#x304C;&#x5BB9;&#x6613;&#x3067;&#x3042;&#x308B;&#x3053;&#x3068;&#x3001;(2) &#x4ED6;&#x306E;&#x30BB;&#x30EC;&#x30AF;&#x30B7;&#x30E7;&#x30F3;&#x30E2;&#x30C7;&#x30EB;&#x306B;&#x3082;&#x5FDC;&#x7528;&#x53EF;&#x80FD;&#x3067;&#x3042;&#x308B;&#x3053;&#x3068;&#x3001;(3) <script type="math/tex; "> \epsilon_1, \epsilon_2 </script> &#x306E;&#x540C;&#x6642;&#x6B63;&#x898F;&#x5206;&#x5E03;&#x306E;&#x4EEE;&#x5B9A;&#x3068;&#x6BD4;&#x3079;&#x3066;&#x5F31;&#x3044;&#x4EEE;&#x5B9A;&#x3067;&#x3088;&#x3044;&#x3053;&#x3068;&#x3001;(4) &#x3053;&#x308C;&#x3089;&#x306E;&#x5206;&#x5E03;&#x306B;&#x95A2;&#x3059;&#x308B;&#x4EEE;&#x5B9A;&#x306F;&#x30BB;&#x30DF;&#x30D1;&#x30E9;&#x63A8;&#x5B9A;&#x306E;&#x305F;&#x3081;&#x306B;&#x3055;&#x3089;&#x306B;&#x5F31;&#x3081;&#x308B;&#x3053;&#x3068;&#x304C;&#x53EF;&#x80FD;&#x3067;&#x3042;&#x308B;&#x3053;&#x3068;&#x3001;&#x3068;&#x3044;&#x3063;&#x305F;&#x5229;&#x70B9;&#x304C;&#x3042;&#x308A;&#x3001;&#x4EBA;&#x6C17;&#x3002;</p>
<p>&#x304A;&#x3055;&#x3089;&#x3044;&#x3060;&#x304C;&#x3001;&#x8981;&#x6C42;&#x3055;&#x308C;&#x308B; key assumption &#x306E;&#x30A8;&#x30C3;&#x30BB;&#x30F3;&#x30B9;&#x306F;&#x4EE5;&#x4E0B;&#x3002;</p>
<p><script type="math/tex; "> \epsilon_2 = \delta \epsilon_1 + \xi, \quad \xi \perp \!\!\! \perp \epsilon_1 </script></p>
<p>&#x8010;&#x4E45;&#x8CA1;&#x306E;&#x6D88;&#x8CBB;&#x3092;&#x8003;&#x3048;&#x305F;&#x5834;&#x5408;&#x3001;&#x300C;&#x6D88;&#x8CBB;&#x65B9;&#x7A0B;&#x5F0F;&#x306E;&#x8AA4;&#x5DEE;&#x300D;&#x306F;&#x300C;&#x8CFC;&#x5165;&#x610F;&#x601D;&#x6C7A;&#x5B9A;&#x65B9;&#x7A0B;&#x5F0F;&#x306E;&#x8AA4;&#x5DEE;&#x306E;&#x500D;&#x6570;&#x300D;&#xFF0B;&#x300C;&#x8CFC;&#x5165;&#x610F;&#x601D;&#x6C7A;&#x5B9A;&#x3068;&#x306F;&#x72EC;&#x7ACB;&#x306E;&#x30CE;&#x30A4;&#x30BA;&#x300D;&#x306B;&#x7B49;&#x3057;&#x3044;&#x3053;&#x3068;&#x3092;&#x8868;&#x3059;&#x3002;CT05&#x3067;&#x306F; &quot;seems to be a quite sensible model&quot; &#x3068;&#x6271;&#x308F;&#x308C;&#x3066;&#x3044;&#x308B;&#x3002;</p>
<p>&#x3088;&#x308A;&#x4E00;&#x822C;&#x5316;&#x3059;&#x308B;&#x3068;&#x3001;Heckman&apos;s two-step method &#x306F; <script type="math/tex; "> \epsilon_1 </script> &#x304C;&#x6B63;&#x898F;&#x5206;&#x5E03;&#x4EE5;&#x5916;&#x306E;&#x5206;&#x5E03;&#x306B;&#x5F93;&#x3046;&#x5834;&#x5408;&#x3082;&#x9069;&#x7528;&#x53EF;&#x80FD;&#x3002;</p>
<h3 id="&#x4F8B;&#xFF1A;&#x8CC3;&#x91D1;&#x95A2;&#x6570;">&#x4F8B;&#xFF1A;&#x8CC3;&#x91D1;&#x95A2;&#x6570;</h3>
<p>&#x305F;&#x3068;&#x3048;&#x3070;&#x3001;&#x8CC3;&#x91D1;&#x95A2;&#x6570;&#x306E;&#x63A8;&#x5B9A;&#x3092;&#x8003;&#x3048;&#x308B;&#x3002;&#x5C31;&#x52B4;&#x3057;&#x3066;&#x3044;&#x306A;&#x3044;&#x4EBA;&#x306E;&#x8CC3;&#x91D1;&#x306F;&#x89B3;&#x6E2C;&#x3055;&#x308C;&#x306A;&#x3044;&#x3002;&#x3082;&#x3057;&#x3001;&#x300C;&#x5C31;&#x52B4;&#x3057;&#x3066;&#x3044;&#x308B;&#x304B;&#x3069;&#x3046;&#x304B;&#x300D;&#x304C;&#x5B8C;&#x5168;&#x306B;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x306B;&#xFF08;&#x5916;&#x751F;&#x7684;&#x306B;&#xFF09;&#x6C7A;&#x5B9A;&#x3055;&#x308C;&#x308B;&#x306E;&#x3067;&#x3042;&#x308C;&#x3070;&#x3001;&#x89B3;&#x6E2C;&#x3055;&#x308C;&#x308B;&#x30C7;&#x30FC;&#x30BF;&#xFF08;&#x5C31;&#x52B4;&#x3057;&#x3066;&#x3044;&#x308B;&#x4EBA;&#x306E;&#x5206;&#xFF09;&#x3060;&#x3051;&#x3092;&#x4F7F;&#x3063;&#x3066;&#x8CC3;&#x91D1;&#x95A2;&#x6570;&#x3092;&#x63A8;&#x8A08;&#x3059;&#x308B;&#x3053;&#x3068;&#x3067;&#x4F55;&#x3089;&#x554F;&#x984C;&#x306F;&#x306A;&#x3044;&#x3002;</p>
<p>&#x3057;&#x304B;&#x3057;&#x3001;&#x73FE;&#x5B9F;&#x306B;&#x306F;&#x30E9;&#x30F3;&#x30C0;&#x30E0;&#x3067;&#x306F;&#x306A;&#x3044;&#x3002;&#x3053;&#x306E;&#x3088;&#x3046;&#x306A;&#x5834;&#x5408;&#x3001;&#x30B5;&#x30F3;&#x30D7;&#x30EB;&#x30BB;&#x30EC;&#x30AF;&#x30B7;&#x30E7;&#x30F3; sample selection &#x306E;&#x554F;&#x984C;&#x304C;&#x751F;&#x3058;&#x308B;&#x3002;</p>
<p><script type="math/tex; "> Y_i = \begin{cases} a + b x_i + u_i \quad \text{if} \quad M_i = 1 \\ . \text{ (unobservable)} \quad \text{if} \quad M_i = 0 \end{cases} </script></p>
<p><script type="math/tex; "> M_i = \begin{cases} 1 \quad \text{if} \quad M_i^{*} > m \\ 0 \quad \text{if} \quad M_i^{*} \le m \end{cases} , \quad M_i^* = \alpha + \beta z_i + v_i </script></p>
<ul>
<li><script type="math/tex; "> Y </script>: &#x89B3;&#x6E2C;&#x3055;&#x308C;&#x308B;&#x8CC3;&#x91D1;</li>
<li><script type="math/tex; "> x </script>: &#x500B;&#x4EBA;&#x5C5E;&#x6027;&#xFF08;&#x6559;&#x80B2;&#x5E74;&#x6570;&#x306A;&#x3069;&#xFF09;</li>
<li><script type="math/tex; "> M </script>: &#x5C31;&#x52B4;&#x3057;&#x3066;&#x3044;&#x308B;&#x304B;&#x3069;&#x3046;&#x304B; (in labor force --&gt; 1, or not --&gt; 0)</li>
<li><script type="math/tex; "> z </script>: IV</li>
</ul>
<p>cf. <a href="https://www.researchgate.net/figure/Tobit-model-vs-OLS-Consistent-estimates-of-the-parameters-of-the-Tobit-model-may-be_fig2_255606959" target="_blank">Tobit&#x3068;&#x7DDA;&#x5F62;&#x30E2;&#x30C7;&#x30EB;&#x3092;&#x6BD4;&#x8F03;&#x3057;&#x305F;&#x5206;&#x304B;&#x308A;&#x3084;&#x3059;&#x3044;&#x56F3;</a></p>
<h2 id="&#x767A;&#x5C55;-ct05-section-169">&#x767A;&#x5C55; [CT05, Section 16.9]</h2>
<p>Tobit model <script type="math/tex; "> y_i^{*} = \mathbf{x}_i' \beta + \epsilon_i </script> &#x306E;&#x4EEE;&#x5B9A; <script type="math/tex; "> \epsilon_i \sim N[0, \sigma_i^2] </script> &#x306F;&#x7DE9;&#x548C;&#x53EF;&#x80FD;&#xFF1A;
(1) &#x4E0D;&#x5747;&#x4E00;&#x6027;&#x3092;&#x660E;&#x793A;&#x7684;&#x306B;&#x30E2;&#x30C7;&#x30EB;&#x5316;&#x3059;&#x308B;&#xFF1A;<script type="math/tex; "> \sigma_i^2 = \exp(\mathbf{z}_i' \gamma) </script>
(2) &#x6B63;&#x898F;&#x5206;&#x5E03;&#x3088;&#x308A;&#x3082;&#x67D4;&#x8EDF;&#x306A;&#x5206;&#x5E03; (squared polynomial expansion of the normal, etc.) &#x3092;&#x7528;&#x3044;&#x308B;</p>
<p>Bivariate sample selection model &#x306B;&#x5BFE;&#x3057;&#x3066;&#x3082;&#x540C;&#x69D8;&#x3067;&#x3001;&#x305F;&#x3068;&#x3048;&#x3070; Lee (ECTA 1983) &#x306F; <script type="math/tex; "> (\epsilon_1, \epsilon_2) </script> &#x3092;2&#x5909;&#x91CF;&#x6B63;&#x898F;&#x5206;&#x5E03;&#x306E;&#x4EEE;&#x5B9A;&#x304C;&#x3088;&#x308A;&#x59A5;&#x5F53;&#x3068;&#x306A;&#x308B;&#x3088;&#x3046;&#x306A;&#x5909;&#x63DB;&#x3092;&#x63D0;&#x6848;&#x3057;&#x305F;&#x3002;</p>
<h2 id="&#x7D71;&#x8A08;&#x30BD;&#x30D5;&#x30C8;&#x30A6;&#x30A7;&#x30A2;">&#x7D71;&#x8A08;&#x30BD;&#x30D5;&#x30C8;&#x30A6;&#x30A7;&#x30A2;</h2>
<h3 id="r">R</h3>
<pre><code class="lang-R"><span class="hljs-comment"># install.packages(&quot;sampleSelection&quot;)</span>
<span class="hljs-keyword">library</span>(sampleSelection)
data(Mroz87)
h0 &lt;- heckit(selection = lfp ~ age + I(age^<span class="hljs-number">2</span>) + faminc + I(kids5 + kids618) + educ,
  outcome = wage ~ exper + I(exper^<span class="hljs-number">2</span>) + educ + city, Mroz87)
summary(h0)
</code></pre>
<h3 id="stata">Stata</h3>
<pre><code class="lang-Stata"><span class="hljs-keyword">use</span> <span class="hljs-string">&quot;http://www.stata.com/data/jwooldridge/eacsap/mroz&quot;</span>, <span class="hljs-keyword">clear</span>
<span class="hljs-keyword">replace</span> wage = . <span class="hljs-keyword">if</span> wage == 0
<span class="hljs-keyword">generate</span> exper2 = exper^2
<span class="hljs-keyword">generate</span> age2 = age^2
<span class="hljs-keyword">generate</span> kids = kidslt6 + kidsge6
<span class="hljs-keyword">heckman</span> wage exper exper2 educ city, select(age age2 faminc kids educ)
</code></pre>
<p>cf. Wooldridge &quot;Econometric Analysis of Cross Section and Panel Data&quot; &#x306E; <a href="https://www.stata.com/texts/eacsap/" target="_blank">.dta &#x30D5;&#x30A1;&#x30A4;&#x30EB;</a></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="regression.html" class="navigation navigation-prev " aria-label="Previous page: 線形回帰">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="site.html" class="navigation navigation-next " aria-label="Next page: 本サイト">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Heckit","level":"1.3","depth":1,"next":{"title":"本サイト","level":"1.4","depth":1,"path":"site.md","ref":"site.md","articles":[]},"previous":{"title":"線形回帰","level":"1.2","depth":1,"path":"regression.md","ref":"regression.md","articles":[]},"dir":"ltr"},"config":{"plugins":["mathjax"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"mathjax":{"forceSVG":false,"version":"2.6-latest"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"markdown-toc.insertAnchor":true,"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"ja","gitbook":"*"},"file":{"path":"heckit.md","mtime":"2020-12-19T16:18:22.335Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-12-19T16:18:32.146Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="https://cdn.mathjax.org/mathjax/2.6-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-mathjax/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

